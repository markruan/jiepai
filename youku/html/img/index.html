<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<title>title</title>
		<link rel="stylesheet" type="text/css" href="../../css/api.css"/>
		<style>
			body {
			}
		</style>
	</head>
	<body></body>
	<script type="text/javascript" src="../../script/api.js"></script>
	<script type="text/javascript">
		function openH() {
			api.openFrame({
				name : 'img2',
				url : '../../html/img/img.html',
				rect : {
					x : 0,
					y : 25,
					w : api.frameWidth,
					h : api.winHeight - 25
				}
			});
		}

		function npic() {
			var photoBrowser = api.require('photoBrowser');
			photoBrowser.getIndex(function(ret, err) {
				if (ret) {
					photoBrowser.setIndex({
						index : ret.index + 1
					});
				} else {
					alert(JSON.stringify(err));
				}
			});
		}

		function bpic() {
			var photoBrowser = api.require('photoBrowser');
			photoBrowser.getIndex(function(ret, err) {
				if (ret) {
					photoBrowser.setIndex({
						index : ret.index - 1
					});
				} else {
					alert(JSON.stringify(err));
				}
			});
		}

		apiready = function() {
			var photoBrowser = api.require('photoBrowser');
			api.ajax({
				url : 'http://114.55.98.130/index.php/Api/outimg.html',
				cache : true,
				dataType : 'json',
				method : 'post',
			}, function(ret, err) {
				var imglenth = ret.length
				var imgarr = ret
				photoBrowser.open({
					images : imgarr,
					activeIndex : 0,
					placeholderImg : 'widget://image/6.jpg',
					bgColor : '#000'
				}, function(ret, err) {
					if (ret.eventType == 'click') {
						openH()
					} else {
					}
					if (ret.eventType == 'change') {
						var index = ret.index + 1;
						api.sendEvent({
							name : 'imglist',
							extra : {
								imglenth : imglenth,
								imgindex : index
							}
						});
					} else {
						//						alert(JSON.stringify(err));
					}
				});
			});
			api.addEventListener({
				name : 'keyback'
			}, function(ret, err) {
				api.closeFrame({
					name : 'img1'
				});
			});
		};
	</script>
</html>